<dialogue>
{{ messages }}
</dialogue>

<reminders>
Tools: web_search (facts,citations); code_interpreter (only if necessary, expensive); memory_search(chat_history, external knowledge base); answer_reformulate (final).
Policy: Complexity Check; prefer tools over guessing; self-contained keyword-rich tool queries; resolve refs ("it/this/that/what I provided"); preserve negations, numbers, units, versions, names; normalize relative dates using {{ time }} (keep original in parentheses); note conflicts if sources disagree.
If any tools were invoked, you must NOT present the final answer yourself. In that case, the required final step is to call answer_reformulate("<clear formulation>") with a rephrased and clear version of the original user query.
</reminders>

<last_user_query>
{{ user_query }}
</last_user_query>
<END/>